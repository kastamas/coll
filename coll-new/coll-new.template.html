<div class="container">
    <h2 ng-show="$ctrl.entityId != undefined" class="page-header">Изменение словосочетания</h2>
    <h2  ng-show="$ctrl.entityId == undefined"  class="page-header">Добавление словосочетания</h2>

    <div ng-show="$ctrl.textsList.length != '0'">
        <form name="form" ng-submit="$ctrl.onAction()" class="stylish-form" novalidate>

        <div class="row">
        <div class="col-md-6">



<div ng-show="$ctrl.entityId != undefined">
        <h4><span class="bold">Принадлежит тексту: </span>
            <span class="blue bold">{{$ctrl.entity.text_name}}</span></h4>
        <br>
</div>

<div  ng-show="$ctrl.entityId == undefined">
    <label for="collText_id" class="red">Текст*</label>  <br>
    <select id="collText_id" ng-model="$ctrl.entity.text_id" class="form-control" required>
        <option data-ng-repeat="item in $ctrl.textsList | orderBy:'title':false " value="{{item.id}}">{{item.title}}</option>
    </select> <br>
</div>

    <label for="collName" class="red">Словосочетание*</label>  <br>
    <input class="text form-control" ng-model="$ctrl.entity.collocation" name="title" id="collName" type="text" required/>
    <br>

    <label for="collName">Номер страницы</label>  <br>
    <input class="text form-control" min="1" max="5000" ng-model="$ctrl.entity.page_number" name="title" id="collPageNumber" type="number">
    <hr>
    <label>Характеристика словосочетания по количеству компонентов</label><br>
        <input type="radio" name="char1" ng-model="$ctrl.entity.characteristic_quantity" ng-change="$ctrl.onChangeCharacteristicQuantity()" id="ch1b" value="2xmem" class="specRadiobutton"> <label for="ch1b" class="btn btn-default"> двучленное</label>
        <input type="radio" name="char1" ng-model="$ctrl.entity.characteristic_quantity" ng-change="$ctrl.onChangeCharacteristicQuantity()"id="ch1a" value="3xmem" class="specRadiobutton"> <label for="ch1a" class="btn btn-default"> трёхчленное</label>
    <br>

    <div ng-show="$ctrl.entity.characteristic_quantity != undefined">  <br>
        <label>Характеристика по отношению к главному слову</label><br>
        <input type="radio" name="char1x" ng-model="$ctrl.entity.characteristic_relation_to_main" ng-change="$ctrl.onChangeCharacteristicRelationToMain()" id="ch1xa" value="prepos"   class="specRadiobutton"> <label for="ch1xa" class="btn btn-default"> препозитивное</label>
        <input type="radio" name="char1x" ng-model="$ctrl.entity.characteristic_relation_to_main" ng-change="$ctrl.onChangeCharacteristicRelationToMain()" id="ch1xc" value="interpos" class="specRadiobutton"> <label for="ch1xc" class="btn btn-default"> интерпозитивное</label>
        <input type="radio" name="char1x" ng-model="$ctrl.entity.characteristic_relation_to_main" ng-change="$ctrl.onChangeCharacteristicRelationToMain()" id="ch1xb" value="postpos"  class="specRadiobutton"> <label for="ch1xb" class="btn btn-default"> постпозитивное</label>
        <input type="radio" name="char1x" ng-model="$ctrl.entity.characteristic_relation_to_main" ng-change="$ctrl.onChangeCharacteristicRelationToMain()" id="ch1xd" value="distant"  class="specRadiobutton"> <label for="ch1xd" class="btn btn-default"> дистантное</label>
    </div>


    <hr>
    <label><span class="red">Текущий статус словосочетания*</span></label><br>
    <input type="radio" name="collStatus" ng-model="$ctrl.entity.status" id="status_d"  value="d" class="specRadiobutton" required> <label for="status_d" class="btn btn-default"> Разобрано</label>
    <input type="radio" name="collStatus" ng-model="$ctrl.entity.status" id="status_a"  value="a" class="specRadiobutton" required> <label for="status_a" class="btn btn-default"> Разобрано не до конца</label>
    <input type="radio" name="collStatus" ng-model="$ctrl.entity.status" id="status_u"  value="u" class="specRadiobutton" required> <label for="status_u" class="btn btn-default"> Не разобрано</label>


</div>
<div class="col-md-6">
    <!--Todo Improve this part-->
    <!--Случай треугольничек-->
    <div ng-show="$ctrl.entity.characteristic_relation_to_main == 'prepos' || $ctrl.entity.characteristic_relation_to_main == 'postpos'">
        <div ng-show="$ctrl.entity.characteristic_quantity == '2xmem'">
            <label>Характеристика атрибута</label>
            <select id="characteristicTwo"
                    ng-model="$ctrl.characteristicAttr1"
                    class="form-control"
                    ng-options="item.id as item.characteristic for item in $ctrl.characteristicTwoList | filter:'attribute'">
            </select>

            <div ng-show="$ctrl.condition_for_showing_extensions($ctrl.characteristicAttr1)">
                <br>
                <label class="red">Дополнение к характеристике атрибута</label>
                <select id="characteristicThree"
                        ng-model="$ctrl.entity.characteristic_attr1"
                        class="form-control"
                        ng-options="item.id as item.expansion for item in $ctrl.characteristicThreeList | filter: characteristicThreeFilter1">
                </select>
            </div>
        </div>
        <div ng-show="$ctrl.entity.characteristic_quantity == '3xmem'">
            <label>Характеристика <span class="blue">первого</span> атрибута</label>
            <select ng-model="$ctrl.characteristicAttr1"
                    class="form-control"
                    ng-options="item.id as item.characteristic for item in $ctrl.characteristicTwoList | filter:'attribute'">
            </select>

            <div ng-show="$ctrl.condition_for_showing_extensions($ctrl.characteristicAttr1)">
                <br>
                <label class="red">Дополнение к характеристике атрибута*</label>
                <select ng-model="$ctrl.entity.characteristic_attr1"
                        class="form-control"
                        ng-options="item.id as item.expansion for item in $ctrl.characteristicThreeList | filter: characteristicThreeFilter1">
                </select>
            </div>
            <hr>
            <label>Характеристика <span class="blue">второго</span> атрибута</label>
            <select  ng-model="$ctrl.characteristicAttr2"
                     class="form-control"
                     ng-options="item.id as item.characteristic for item in $ctrl.characteristicTwoList | filter:'attribute'">
            </select>


            <div ng-show="$ctrl.condition_for_showing_extensions($ctrl.characteristicAttr2)">
                <br>
                <label class="red">Дополнение к характеристике атрибута*</label>
                <select  ng-model="$ctrl.entity.characteristic_attr2"
                         class="form-control"
                         ng-options="item.id as item.expansion for item in $ctrl.characteristicThreeList | filter: characteristicThreeFilter2">
                </select>
            </div>
        </div>


    </div>
    <!--Случай кружок-->
    <div ng-show="$ctrl.entity.characteristic_relation_to_main == 'distant'">
        <div ng-show="$ctrl.entity.characteristic_quantity == '2xmem'">
            <label>Характеристика атрибута</label>
            <select  ng-model="$ctrl.characteristicAttr1"
                     class="form-control"
                     ng-options="item.id as item.characteristic for item in $ctrl.characteristicTwoList | filter:'attribute'">
            </select>
            <div ng-show="$ctrl.condition_for_showing_extensions($ctrl.characteristicAttr1)">
                <br>
                <label class="red">Дополнение к характеристике атрибута</label>
                <select ng-model="$ctrl.entity.characteristic_attr1"
                        class="form-control"
                        ng-options="item.id as item.expansion for item in $ctrl.characteristicThreeList | filter: characteristicThreeFilter1">
                </select>
            </div>
        </div>
        <div ng-show="$ctrl.entity.characteristic_quantity == '3xmem'">
            <label>Характеристика <span class="blue">первого</span> атрибута</label>
            <select  ng-model="$ctrl.characteristicAttr1"
                     class="form-control"
                     ng-options="item.id as item.characteristic for item in $ctrl.characteristicTwoList | filter:'attribute'">
            </select>
            <div ng-show="$ctrl.condition_for_showing_extensions($ctrl.characteristicAttr1)">
                <br>
                <label class="red">Дополнение к характеристике атрибута*</label>
                <select ng-model="$ctrl.entity.characteristic_attr1"
                        class="form-control"
                        ng-options="item.id as item.expansion for item in $ctrl.characteristicThreeList | filter: characteristicThreeFilter1">
                </select>
            </div>

            <hr>

            <label>Характеристика <span class="blue">второго</span> атрибута</label>
            <select  ng-model="$ctrl.characteristicAttr2"
                     class="form-control"
                     ng-options="item.id as item.characteristic for item in $ctrl.characteristicTwoList | filter:'attribute'">
            </select>
            <div ng-show="$ctrl.condition_for_showing_extensions($ctrl.characteristicAttr2)">
                <br>
                <label class="red">Дополнение к характеристике атрибута*</label>
                <select  ng-model="$ctrl.entity.characteristic_attr2"
                         class="form-control"
                         ng-options="item.id as item.expansion for item in $ctrl.characteristicThreeList | filter: characteristicThreeFilter2">
                </select>
            </div>
        </div>
        <hr>
        <label>Характеристика разделителя</label>
        <select  ng-model="$ctrl.entity.characteristic_divider"
                 class="form-control"
                 ng-options="item.id as item.characteristic for item in $ctrl.characteristicTwoList | filter:'divider'">
        </select>
    </div>


    <!--Случай звёздочка-->
    <div ng-show="$ctrl.entity.characteristic_relation_to_main == 'interpos'">
        <label>Характеристика <span class="blue">первого</span> атрибута</label>
        <select
                ng-model="$ctrl.characteristicAttr1"
                class="form-control"
                ng-options="item.id as item.characteristic for item in $ctrl.characteristicTwoList | filter:'attribute'">
        </select>

        <div ng-show="$ctrl.condition_for_showing_extensions($ctrl.characteristicAttr1)">
            <br>
            <label class="red">Дополнение к характеристике атрибута*</label>
            <select  ng-model="$ctrl.entity.characteristic_attr1"
                     class="form-control"
                     ng-options="item.id as item.expansion for item in $ctrl.characteristicThreeList | filter: characteristicThreeFilter1">
            </select>
        </div>
        <hr>
        <label>Характеристика <span class="blue">второго</span> атрибута</label>
        <select  ng-model="$ctrl.characteristicAttr2"
                 class="form-control"
                 ng-options="item.id as item.characteristic for item in $ctrl.characteristicTwoList | filter:'attribute'">
        </select>


        <div ng-show="$ctrl.condition_for_showing_extensions($ctrl.characteristicAttr2)">
            <br>
            <label class="red">Дополнение к характеристике атрибута*</label>
            <select  ng-model="$ctrl.entity.characteristic_attr2"
                     class="form-control"
                     ng-options="item.id as item.expansion for item in $ctrl.characteristicThreeList | filter: characteristicThreeFilter2">
            </select>
        </div>



    </div>
</div>



<!--For Testing
<br>
<pre>{{$ctrl.entity | json}}</pre>
<pre>characteristic_attr1: {{$ctrl.entity.characteristic_attr1}}</pre>
<pre>characteristic_attr2: {{$ctrl.entity.characteristic_attr2}}</pre>
<pre>characteristicAttr1: {{$ctrl.characteristicAttr1}}</pre>
<pre>characteristicAttr2: {{$ctrl.characteristicAttr2}}</pre>
            -->
</div>



            <hr>

            <!--<button type="button" title="Остались незаполненные обязательные поля!" class="btn btn-default btn-lg disabled" value="добавить"  ng-show="form.$error.required">добавить</button>-->



            <!--ToDo: improve Notifies-->
            <div ng-show="$ctrl.entityId == undefined">
                <button type="submit"  title="Остались незаполненные обязательные поля!"  class="btn btn-default btn-lg" value="добавить" ng-class="{'disabled':form.$error.required}">добавить</button>
                <div class="notification text-success"  data-ng-show="$ctrl.sended" >
                    <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                    Добавлено
                </div>
                <div class="notification text-danger" data-ng-show="$ctrl.sendingError">
                    <span class="glyphicon glyphicon-alert" aria-hidden="true"></span>
                     Произошла ошибка! {{$ctrl.notificationMessage}}
                </div>
            </div>
            <div ng-show="$ctrl.entityId != undefined">
                <button type="submit" title="Остались незаполненные обязательные поля!"  class="btn btn-default btn-lg" value="добавить" ng-class="{'disabled':form.$error.required}">изменить</button>
                <div class="notification text-success"  data-ng-show="$ctrl.sended" >
                    <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                    Изменено
                </div>
                <div class="notification text-danger" data-ng-show="$ctrl.sendingError">
                    <span class="glyphicon glyphicon-alert" aria-hidden="true"></span>
                     Произошла ошибка! {{$ctrl.notificationMessage}}
                </div>
            </div>
        </form>
</div>
    <!----------------- message if no texts found ------------------->
    <div class="text-message"  ng-show="$ctrl.textsList.length == '0'">
        <p>Сейчас в базе нет ни одного текста.<br>
            Чтобы добавить словосочетание - должен быть хотя бы один текст.<br>
            <a href="#/texts/new">Добавить текст</a></p>
    </div>
</div>